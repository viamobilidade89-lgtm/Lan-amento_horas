<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Equipe SAP - ZPM</title>
    <style>
        /* Vari√°veis de cores para facilitar mudan√ßas futuras */
        :root {
            --primary-color: #5E22F3;
            --secondary-color: #4517b8;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #333;
            --danger-color: #ef4444;
            --success-color: #10b981;
        }

        body { 
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; 
            background-color: var(--bg-color); 
            margin: 0; 
            padding: 20px; 
            color: var(--text-color); 
        }

        /* Topo e Logo */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }

        .logo-container img {
            max-width: 200px; /* Ajuste o tamanho conforme necess√°rio */
            height: auto;
            margin-bottom: 10px;
        }

        h1 { margin: 10px 0; color: var(--primary-color); font-size: 1.8rem; }

        /* Containers e Cards */
        .container { 
            background-color: var(--card-bg); 
            padding: 20px; 
            border-radius: 12px; 
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); 
            margin-bottom: 25px; 
            border: 1px solid #e5e7eb;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--primary-color);
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        /* Formul√°rios e Inputs */
        .grid-campos { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 12px; 
            margin-bottom: 15px; 
        }

        input, select { 
            padding: 12px; 
            border: 1px solid #d1d5db; 
            border-radius: 8px; 
            font-size: 14px;
            transition: border-color 0.2s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(94, 34, 243, 0.1);
        }

        /* Bot√µes */
        button { 
            padding: 12px 20px; 
            font-weight: 600;
            border-radius: 8px; 
            cursor: pointer; 
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary { background-color: var(--primary-color); color: white; }
        .btn-primary:hover { background-color: var(--secondary-color); transform: translateY(-1px); }

        .btn-danger { background-color: var(--danger-color); color: white; padding: 6px 12px; font-size: 12px; }
        .btn-danger:hover { background-color: #dc2626; }

        /* Tabelas */
        .table-wrapper { overflow-x: auto; border-radius: 8px; border: 1px solid #e5e7eb; }
        table { width: 100%; border-collapse: collapse; background: white; }
        thead { background-color: var(--primary-color); color: white; }
        th { padding: 15px; font-weight: 600; text-transform: uppercase; font-size: 12px; letter-spacing: 0.05em; }
        td { padding: 12px 15px; text-align: center; border-bottom: 1px solid #f3f4f6; font-size: 14px; }
        tr:last-child td { border-bottom: none; }
        tr:hover { background-color: #f9fafb; }

        /* Checkbox customizado */
        input[type="checkbox"] { width: 18px; height: 18px; cursor: pointer; }

        footer { 
            text-align: center; 
            padding: 30px; 
            color: #6b7280; 
            font-size: 14px;
        }
        
        .badge-sap {
            background: #e0e7ff;
            color: var(--primary-color);
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 11px;
        }
    </style>
</head>
<body>

    <header>
        <div class="logo-container">
            <img src="https://share.google/6a90NGpixt2Yt5Pag" alt="Logo Empresa">
        </div>
        <h1>Gerenciador de Lan√ßamentos ZPM</h1>
    </header>

    <div class="container">
        <div class="section-title">
            <span>‚ûï</span> <h3>Gerenciar Base de Dados</h3>
        </div>
        <div class="grid-campos">
            <input type="text" id="addNome" placeholder="NOME COMPLETO">
            <input type="text" id="addRE" placeholder="RE (ex: 59-0000)">
            <input type="text" id="addNumero" placeholder="N¬∫ PESSOAL">
            <select id="addEquipe">
                <option value="Energia">Energia</option>
                <option value="Sinaliza√ß√£o">Sinaliza√ß√£o</option>
                <option value="ALPHA">ALPHA</option>
            </select>
            <select id="addEscala">
                <option value="Noturno">Noturno</option>
                <option value="DIURNO">DIURNO</option>
            </select>
            <button class="btn-primary" onclick="adicionarNovoColaborador()">Salvar Colaborador</button>
        </div>
    </div>

    <div class="container">
        <div class="section-title">
            <span>üîç</span> <h3>Filtrar e Selecionar Equipe</h3>
        </div>
        <div class="grid-campos" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
            <select id="filtroEquipe"><option value="">Todas as Equipes</option></select>
            <select id="filtroEscala"><option value="">Todas as Escalas</option></select>
            <button class="btn-primary" onclick="aplicarFiltros()">Aplicar Filtro</button>
        </div>

        <div class="table-wrapper">
            <table id="tabela-colaboradores">
                <thead>
                    <tr>
                        <th>Sel.</th>
                        <th>Nome</th>
                        <th>RE</th>
                        <th>N√∫mero</th>
                        <th>Escala</th>
                        <th>Equipe</th>
                        <th>A√ß√£o</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div class="container">
        <div class="section-title">
            <span>‚öôÔ∏è</span> <h3>Configurar Opera√ß√µes</h3>
        </div>
        <form id="meuFormulario">
            <div class="grid-campos" style="grid-template-columns: 1fr auto;">
                <input type="number" required id="numeroOrdem" placeholder="Digite o n√∫mero da Ordem SAP">
                <button type="submit" class="btn-primary">Adicionar Linha de Hor√°rio</button>
            </div>
        </form>

        <div class="table-wrapper" style="margin-top: 20px;">
            <table id="tabelaOperacoes">
                <thead>
                    <tr>
                        <th>Opera√ß√£o</th>
                        <th>C√≥digo</th>
                        <th>Data In√≠cio</th>
                        <th>Hora In√≠cio</th>
                        <th>Data Fim</th>
                        <th>Hora Fim</th>
                        <th>Remover</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div style="text-align: center; margin-bottom: 40px; display: flex; justify-content: center; gap: 15px;">
        <button id="criarTabela" style="display: none;" class="btn-primary" onclick="createTable()">üöÄ Gerar Tabela Final</button>
        <button id="copiar" style="display: none; background-color: var(--success-color); color: white;" onclick="copiarFormatoPersonalizado()">üìã Copiar para SAP</button>
        <button id="excluir" style="display: none;" class="btn-danger" onclick="excluirCorpo()">üóëÔ∏è Limpar Tudo</button>
    </div>

    <div class="table-wrapper">
        <table id="tabelaLancto">
            <thead>
                <tr>
                    <th>Ordem</th><th>C√≥d.</th><th>N√∫mero</th><th>Data In√≠.</th><th>Hora In√≠.</th><th>Data Fim</th><th>Hora Fim</th><th>Confirma√ß√£o</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <footer>
        <p>Desenvolvido por <strong>Lucas Santana</strong></p>
        <p>Equipe Sinaliza√ß√£o ¬© 2026 | Sistema de Apoio ZPM</p>
    </footer>

    <script>
        // MANTENDO TODA A L√ìGICA ORIGINAL QUE VOC√ä J√Å TINHA
        const listaOriginal = [
            {"nome":"ADRIANO","re":"59-01777","numero":"20579","equipe":"Energia","escala":"Noturno"},
            {"nome":"ALEX","re":"59-02966","numero":"23097","equipe":"Energia","escala":"Noturno"},
            {"nome":"BRUNO","re":"59-04951","numero":"19540","equipe":"Energia","escala":"Noturno"},
            {"nome":"CLAUDEMIR","re":"59-01651","numero":"20651","equipe":"Energia","escala":"Noturno"},
            {"nome":"EUDES","re":"59-03110","numero":"","equipe":"Energia","escala":"Noturno"},
            {"nome":"GILMERSON","re":"59-02315","numero":"24056","equipe":"Energia","escala":"Noturno"},
            {"nome":"GRACINO","re":"59-00447","numero":"20806","equipe":"Energia","escala":"Noturno"},
            {"nome":"GREG√ìRIO","re":"59-02738","numero":"","equipe":"Energia","escala":"Noturno"},
            {"nome":"IAGO","re":"59-02975","numero":"23584","equipe":"Energia","escala":"Noturno"},
            {"nome":"JAILSON","re":"59-03141","numero":"23924","equipe":"Energia","escala":"Noturno"},
            {"nome":"JONE","re":"59-02967","numero":"24207","equipe":"Energia","escala":"Noturno"},
            {"nome":"JUNIOR","re":"59-01825","numero":"20903","equipe":"Energia","escala":"Noturno"},
            {"nome":"KAMILYN","re":"59-04350","numero":"24587","equipe":"Energia","escala":"Noturno"},
            {"nome":"LEANDRO","re":"59-03077","numero":"14791","equipe":"Energia","escala":"Noturno"},
            {"nome":"LUCIANO","re":"59-03444","numero":"23090","equipe":"Energia","escala":"Noturno"},
            {"nome":"MARCELO","re":"59-02318","numero":"23672","equipe":"Energia","escala":"Noturno"},
            {"nome":"PAULO","re":"59-01797","numero":"21031","equipe":"Energia","escala":"Noturno"},
            {"nome":"RODRIGO","re":"59-02849","numero":"","equipe":"Energia","escala":"Noturno"},
            {"nome":"RUTEMBERG","re":"59-00332","numero":"21096","equipe":"Energia","escala":"Noturno"},
            {"nome":"SIDNEI","re":"59-03370","numero":"24520","equipe":"Energia","escala":"Noturno"},
            {"nome":"NINGUEM","re":"59-00000","numero":"000001","equipe":"Energia","escala":"DIURNO"},
            {"nome":"NAO SEI","re":"59-00001","numero":"000002","equipe":"ALPHA","escala":"Noturno"},
            {"nome":"VAGNER","re":"59-04500","numero":"24932","equipe":"Energia","escala":"Noturno"},
            {"nome":"VALTER","re":"59-00793","numero":"21131","equipe":"Energia","escala":"Noturno"},
            {"nome":"WILLIAM FAUSTO","re":"59-04340","numero":"24435","equipe":"Energia","escala":"Noturno"},
            {"nome":"WILLIAN ALMEIDA","re":"59-03331","numero":"22589","equipe":"Energia","escala":"Noturno"}
        ];

        let colaboradores = JSON.parse(localStorage.getItem('db_colaboradores')) || listaOriginal;

        const operacoes = [
            { nome: "Prepara√ß√£o", codigo: "0010" }, { nome: "Deslocamento", codigo: "0020" },
            { nome: "Acesso", codigo: "0030" }, { nome: "Impedimento", codigo: "0040" },
            { nome: "Desmobiliza√ß√£o", codigo: "0050" }, { nome: "Execu√ß√£o", codigo: "0060" },
            { nome: "Execu√ß√£o", codigo: "0070" }, { nome: "Execu√ß√£o", codigo: "0080" },
            { nome: "Execu√ß√£o", codigo: "0090" }
        ];

        function salvarNoBanco() { localStorage.setItem('db_colaboradores', JSON.stringify(colaboradores)); }

        function preencherFiltros() {
            const fEq = document.getElementById('filtroEquipe');
            const fEs = document.getElementById('filtroEscala');
            fEq.innerHTML = '<option value="">Todas as Equipes</option>';
            fEs.innerHTML = '<option value="">Todas as Escalas</option>';
            [...new Set(colaboradores.map(c => c.equipe))].forEach(eq => fEq.innerHTML += `<option value="${eq}">${eq}</option>`);
            [...new Set(colaboradores.map(c => c.escala))].forEach(es => fEs.innerHTML += `<option value="${es}">${es}</option>`);
        }

        function renderTabela(lista) {
            const tbody = document.querySelector('#tabela-colaboradores tbody');
            tbody.innerHTML = '';
            lista.forEach((colab) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><input type="checkbox" class="selecionar" data-re="${colab.re}"></td>
                    <td style="text-align: left; font-weight: 500;">${colab.nome}</td>
                    <td><span class="badge-sap">${colab.re}</span></td>
                    <td>${colab.numero}</td>
                    <td>${colab.escala}</td>
                    <td>${colab.equipe}</td>
                    <td><button class="btn-danger" onclick="removerColab('${colab.re}')">Apagar</button></td>
                `;
                tbody.appendChild(tr);
            });
        }

        function adicionarNovoColaborador() {
            const nome = document.getElementById('addNome').value.toUpperCase();
            const re = document.getElementById('addRE').value;
            const num = document.getElementById('addNumero').value;
            const eq = document.getElementById('addEquipe').value;
            const esc = document.getElementById('addEscala').value;
            if(!nome || !re) return alert("Preencha Nome e RE");
            colaboradores.push({nome, re, numero: num, equipe: eq, escala: esc});
            salvarNoBanco(); preencherFiltros(); renderTabela(colaboradores);
            document.getElementById('addNome').value = ""; document.getElementById('addRE').value = "";
        }

        function removerColab(re) {
            if(confirm("Deseja excluir este colaborador da base?")) {
                colaboradores = colaboradores.filter(c => c.re !== re);
                salvarNoBanco(); preencherFiltros(); renderTabela(colaboradores);
            }
        }

        function aplicarFiltros() {
            const eq = document.getElementById('filtroEquipe').value;
            const esc = document.getElementById('filtroEscala').value;
            const filtrados = colaboradores.filter(c => (eq === '' || c.equipe === eq) && (esc === '' || c.escala === esc));
            renderTabela(filtrados);
        }

        document.getElementById('meuFormulario').addEventListener('submit', function(e) {
            e.preventDefault();
            const tbody = document.querySelector("#tabelaOperacoes tbody");
            const tr = document.createElement("tr");
            const selOp = document.createElement("select");
            operacoes.forEach(o => { selOp.innerHTML += `<option value="${o.codigo}">${o.nome} (${o.codigo})</option>`; });
            let local = new Date(); local.setMinutes(local.getMinutes() - local.getTimezoneOffset());
            const data = local.toJSON().slice(0,10);
            tr.innerHTML = `
                <td></td><td class="c-op" style="font-weight:bold; color:var(--primary-color);"></td>
                <td><input type="date" value="${data}"></td>
                <td><input type="time" required></td>
                <td><input type="date" value="${data}"></td>
                <td><input type="time" required></td>
                <td><button type="button" class="btn-danger" onclick="this.closest('tr').remove()">X</button></td>
                <td style="display:none">${document.getElementById("numeroOrdem").value}</td>
            `;
            tr.children[0].appendChild(selOp);
            tr.querySelector(".c-op").textContent = selOp.value;
            selOp.onchange = () => tr.querySelector(".c-op").textContent = selOp.value;
            tbody.appendChild(tr);
            document.getElementById("criarTabela").style.display="inline-flex";
        });

        function createTable() {
            const tbodyLacto = document.querySelector("#tabelaLancto tbody");
            tbodyLacto.innerHTML = "";
            const selecionados = [];
            document.querySelectorAll('.selecionar:checked').forEach(cb => {
                const encontrado = colaboradores.find(c => c.re === cb.dataset.re);
                if(encontrado) selecionados.push(encontrado);
            });
            if(selecionados.length === 0) return alert("Selecione colaboradores na tabela acima!");
            document.querySelectorAll("#tabelaOperacoes tbody tr").forEach(op => {
                const dIn = op.children[2].children[0].value.split("-").reverse().join(".");
                const dFim = op.children[4].children[0].value.split("-").reverse().join(".");
                const hIn = op.children[3].children[0].value;
                const hFim = op.children[5].children[0].value;
                const ord = op.children[7].textContent;
                const cod = op.querySelector(".c-op").textContent;
                selecionados.forEach(p => {
                    const tr = document.createElement("tr");
                    let txt = p.numero === "" ? `${p.nome} ${p.re}` : "";
                    tr.innerHTML = `<td>${ord}</td><td>${cod}</td><td>${p.numero}</td><td>${dIn}</td><td>${hIn}:00</td><td>${dFim}</td><td>${hFim}:00</td><td style="text-align:left">${txt}</td>`;
                    tbodyLacto.append(tr);
                });
            });
            document.getElementById("copiar").style.display="inline-flex";
            document.getElementById("excluir").style.display="inline-flex";
        }

        function copiarFormatoPersonalizado() {
            let texto = "";
            document.querySelectorAll("#tabelaLancto tbody tr").forEach(linha => {
                const col = linha.querySelectorAll("td");
                const ord = col[0].textContent; const cod = col[1].textContent;
                const dados = Array.from(col).slice(2, 7).map(c => c.textContent);
                const conf = col[7].textContent;
                texto += `${ord}\t${cod}${"\t".repeat(8)}${dados.join("\t")}\t\t${conf}\n`;
            });
            navigator.clipboard.writeText(texto).then(() => alert("Copiado com sucesso! Agora √© s√≥ colar no SAP ZPM."));
        }

        function excluirCorpo() { 
            if(confirm("Limpar todos os dados gerados?")) document.querySelector("#tabelaLancto tbody").innerHTML = ""; 
        }

        preencherFiltros();
        renderTabela(colaboradores);
    </script>
</body>
</html>
