<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SinalizaÃ§Ã£o - LanÃ§amento de Horas SAP</title>
    <style>
        :root { --roxo: #5E22F3; --verde: #28a745; --vermelho: #dc3545; --fundo: #f4f6f8; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--fundo); margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.2); }
        
        .header { text-align: center; margin-bottom: 30px; border-bottom: 3px solid var(--roxo); padding-bottom: 20px; }
        .logo-motiva { width: 200px; fill: var(--roxo); }
        
        .status-audio { background: #222; color: #fff; padding: 10px; border-radius: 8px; margin-bottom: 20px; text-align: center; border: 1px solid var(--roxo); cursor: pointer; }
        
        .secao { background: #fff; border: 1px solid #ddd; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        h3 { color: var(--roxo); margin-top: 0; text-transform: uppercase; font-size: 16px; }

        .grid-campos { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-bottom: 15px; }
        input, select { padding: 12px; border: 1px solid #ccc; border-radius: 6px; width: 100%; box-sizing: border-box; }

        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 13px; }
        th { background: var(--roxo); color: white; padding: 12px; border: 1px solid #ddd; }
        td { padding: 10px; border: 1px solid #ddd; text-align: center; }

        button { padding: 12px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-gerar { background: var(--roxo); color: white; width: 100%; font-size: 16px; margin-top: 10px; }
        .btn-copiar { background: var(--verde); color: white; width: 100%; font-size: 18px; margin-top: 20px; padding: 20px; }
        .btn-limpar { background: var(--vermelho); color: white; font-size: 12px; padding: 5px 15px; }
        
        .check-colab { transform: scale(1.5); cursor: pointer; }
        .footer { text-align: center; margin-top: 30px; color: #777; font-size: 12px; }
    </style>
</head>
<body onclick="iniciarAudio()">

    <audio id="playerOriginal" loop src="musica.mp3"></audio>

    <div class="container">
        <div id="aviso-audio" class="status-audio">
            ðŸŽµ CLIQUE AQUI PARA ATIVAR O SOM DA EQUIPE
        </div>

        <div class="header">
            <svg class="logo-motiva" viewBox="0 0 160 32" xmlns="http://www.w3.org/2000/svg">
                <path d="M37.5196 18.8391C34.1558 22.2567 36.0774 26.0881 33.2459 28.9655C32.0378 30.1954 30.3049 31.1111 28.3379 31.1111V16.7088C30.0029 16.7088 31.7056 16.2222 33.3252 14.5747C36.689 11.1571 34.7674 7.3295 37.5989 4.44828C38.8108 3.21839 40.5852 2.31801 42.5069 2.30269V16.705C40.8268 16.705 39.1393 17.1916 37.5196 18.8391Z"></path>
                <path d="M23.3507 18.8391C19.9868 22.2567 21.9085 26.0881 19.0769 28.9655C17.8688 30.1954 16.1359 31.1111 14.169 31.1111V16.7088C15.8339 16.7088 17.5366 16.2222 19.1562 14.5747C22.5201 11.1571 20.5984 7.3295 23.4299 4.44828C24.6418 3.21839 26.4163 2.31801 28.3379 2.30269V16.705C26.6579 16.705 24.9703 17.1916 23.3507 18.8391Z"></path>
                <path d="M9.18169 18.8391C5.81784 22.2567 7.7395 26.0881 4.90798 28.9655C3.69986 30.1954 1.92166 31.0996 0 31.1111V16.7088C1.66494 16.7088 3.36763 16.2222 4.98726 14.5747C8.35111 11.1571 6.42945 7.3295 9.26097 4.44828C10.4729 3.21839 12.2473 2.31801 14.169 2.30269V16.705C12.4889 16.705 10.8013 17.1916 9.18169 18.8391Z"></path>
            </svg>
            <h1>LanÃ§amento de Horas - ZPM SAP</h1>
        </div>

        <div class="secao">
            <h3>1. Equipe</h3>
            <div style="max-height: 250px; overflow-y: auto;">
                <table id="tabelaColaboradores">
                    <thead>
                        <tr><th>âœ”</th><th>Colaborador</th><th>RE</th><th>NÂº Pessoal</th></tr>
                    </thead>
                    <tbody id="listaPessoas">
                        <tr><td><input type="checkbox" class="check-colab" data-sap="20579"></td><td>ADRIANO</td><td>59-01777</td><td>20579</td></tr>
                        <tr><td><input type="checkbox" class="check-colab" data-sap="23097"></td><td>ALEX</td><td>59-02966</td><td>23097</td></tr>
                        <tr><td><input type="checkbox" class="check-colab" data-sap="19540"></td><td>BRUNO</td><td>59-04951</td><td>19540</td></tr>
                        <tr><td><input type="checkbox" class="check-colab" data-sap="20651"></td><td>CLAUDEMIR</td><td>59-01651</td><td>20651</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="secao">
            <h3>2. Dados da Ordem e HorÃ¡rios</h3>
            <div class="grid-campos">
                <input type="number" id="campoOrdem" placeholder="NÂº da Ordem">
                <input type="date" id="campoData">
                <select id="campoOperacao">
                    <option value="0010">0010 - PreparaÃ§Ã£o</option>
                    <option value="0020">0020 - Deslocamento</option>
                    <option value="0030">0030 - Acesso</option>
                    <option value="0060">0060 - ExecuÃ§Ã£o</option>
                    <option value="0090">0090 - DesmobilizaÃ§Ã£o</option>
                </select>
            </div>
            <div class="grid-campos">
                <input type="time" id="campoInicio" value="08:00">
                <input type="time" id="campoFim" value="17:00">
                <button class="btn-gerar" onclick="adicionarAoLancamento()">ðŸš€ ADICIONAR LINHAS</button>
            </div>
        </div>

        <div class="secao">
            <div style="display: flex; justify-content: space-between;">
                <h3>3. Resultado para o SAP</h3>
                <button class="btn-limpar" onclick="limparTabela()">LIMPAR CORPO</button>
            </div>
            <table id="tabelaFinal">
                <thead>
                    <tr><th>Ordem</th><th>Op.</th><th>NÂº Pessoal</th><th>Data</th><th>InÃ­cio</th><th>Fim</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <button class="btn-copiar" onclick="copiarParaSAP()">ðŸ“‹ COPIAR TUDO (ZPM)</button>
        </div>

        <div class="footer">
            Sistema de LanÃ§amento SinalizaÃ§Ã£o - Lucas Santana Â© 2026
        </div>
    </div>

    <script>
        function iniciarAudio() {
            const player = document.getElementById('playerOriginal');
            player.play().catch(() => {});
            document.getElementById('aviso-audio').innerText = "ðŸŽµ SOM ATIVADO - BOA OPERAÃ‡ÃƒO!";
        }

        function adicionarAoLancamento() {
            const ordem = document.getElementById('campoOrdem').value;
            const dataRaw = document.getElementById('campoData').value;
            const op = document.getElementById('campoOperacao').value;
            const hI = document.getElementById('campoInicio').value;
            const hF = document.getElementById('campoFim').value;
            const selecionados = document.querySelectorAll('.check-colab:checked');

            if(!ordem || !dataRaw || selecionados.length === 0) {
                alert("Preencha Ordem, Data e selecione a equipe!");
                return;
            }

            const dataSap = dataRaw.split('-').reverse().join('.');
            const tbody = document.querySelector("#tabelaFinal tbody");

            selecionados.forEach(s => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${ordem}</td><td>${op}</td><td>${s.dataset.sap}</td><td>${dataSap}</td><td>${hI}:00</td><td>${hF}:00</td>`;
                tbody.appendChild(tr);
            });
        }

        function copiarParaSAP() {
            let areaTexto = "";
            const linhas = document.querySelectorAll("#tabelaFinal tbody tr");
            
            linhas.forEach(linha => {
                const td = linha.querySelectorAll("td");
                // A formataÃ§Ã£o exata com TABS para colar no SAP
                areaTexto += `${td[0].innerText}\t${td[1].innerText}\t\t\t\t\t\t\t\t\t${td[2].innerText}\t${td[3].innerText}\t${td[4].innerText}\t${td[5].innerText}\n`;
            });

            navigator.clipboard.writeText(areaTexto);
            alert("Copiado! Agora Ã© sÃ³ colar no SAP.");
        }

        function limparTabela() {
            document.querySelector("#tabelaFinal tbody").innerHTML = "";
        }

        // Data padrÃ£o de hoje
        document.getElementById('campoData').valueAsDate = new Date();
    </script>
</body>
</html>
