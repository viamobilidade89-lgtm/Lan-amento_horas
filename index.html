<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Lançamentos SAP - Equipe Sinalização</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f4f6f8; margin: 20px; color: #333; }
        h1, h3 { text-align: center; color: #5E22F3; }
        .container { background-color: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .filtros { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; flex-wrap: wrap; }
        select, input, button { padding: 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 5px; }
        button { background-color: #5E22F3; color: white; border: none; cursor: pointer; font-weight: bold; }
        button:hover { background-color: #4517b8; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background-color: white; font-size: 13px; }
        thead { background-color: #5E22F3; color: white; }
        th, td { padding: 8px; text-align: center; border: 1px solid #ddd; }
        tr:hover { background-color: #f1f1f1; }
        footer { text-align:center; padding:15px; color:white; background-color:#5E22F3; margin-top: 30px; border-radius: 8px; }
    </style>
</head>
<body>

    <h1>Gerenciador de Equipe SAP</h1>

    <div class="container">
        <h3>1. Selecionar Colaboradores</h3>
        <div class="filtros">
            <select id="filtroEquipe"><option value="">Todas as Equipes</option></select>
            <select id="filtroEscala"><option value="">Todas as Escalas</option></select>
            <button onclick="aplicarFiltros()">Filtrar Lista</button>
        </div>
        <table id="tabela-colaboradores">
            <thead>
                <tr>
                    <th>Selecionar</th>
                    <th>Nome</th>
                    <th>RE</th>
                    <th>Número SAP</th>
                    <th>Escala</th>
                    <th>Equipe</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="container">
        <h3>2. Dados da Ordem e Operações</h3>
        <div class="filtros">
            <input type="number" id="numeroOrdem" placeholder="Nº da Ordem">
            <button onclick="adicionarOperacao()">+ Adicionar Operação</button>
        </div>
        <table id="tabelaOperacoes">
            <thead>
                <tr>
                    <th>Operação</th>
                    <th>Código</th>
                    <th>Data Início</th>
                    <th>Hora Início</th>
                    <th>Data Fim</th>
                    <th>Hora Fim</th>
                    <th>Ação</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div style="text-align: center; gap: 10px; display: flex; justify-content: center;">
        <button style="background-color: #28a745; padding: 15px 30px;" onclick="createTable()">GERAR LANÇAMENTO FINAL</button>
        <button style="background-color: #d9534f;" onclick="excluirCorpo()">Limpar Resultado</button>
    </div>

    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <h2>Preview ZPM</h2>
            <button style="background-color: #007bff;" onclick="copiarFormatoPersonalizado()">Copiar para SAP</button>
        </div>
        <table id="tabelaLancto">
            <thead>
                <tr>
                    <th>Ordem</th><th>Cód.</th><th>Número</th><th>Data Iní.</th><th>Hora Iní.</th><th>Data Fim</th><th>Hora Fim</th><th>Confirmação</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <footer>Criado por <strong>Lucas Santana</strong> - Equipe Sinalização © 2025</footer>

<script>
    const colaboradores = [
        {"nome":"ADRIANO","re":"59-01777","numero":"20579","equipe":"Energia","escala":"Noturno"},
        {"nome":"ALEX","re":"59-02966","numero":"23097","equipe":"Energia","escala":"Noturno"},
        {"nome":"BRUNO","re":"59-04951","numero":"19540","equipe":"Energia","escala":"Noturno"},
        {"nome":"CLAUDEMIR","re":"59-01651","numero":"20651","equipe":"Energia","escala":"Noturno"},
        {"nome":"EUDES","re":"59-03110","numero":"","equipe":"Energia","escala":"Noturno"},
        {"nome":"GILMERSON","re":"59-02315","numero":"24056","equipe":"Energia","escala":"Noturno"},
        {"nome":"GRACINO","re":"59-00447","numero":"20806","equipe":"Energia","escala":"Noturno"},
        {"nome":"GREGÓRIO","re":"59-02738","numero":"","equipe":"Energia","escala":"Noturno"},
        {"nome":"IAGO","re":"59-02975","numero":"23584","equipe":"Energia","escala":"Noturno"},
        {"nome":"JAILSON","re":"59-03141","numero":"23924","equipe":"Energia","escala":"Noturno"},
        {"nome":"JONE","re":"59-02967","numero":"24207","equipe":"Energia","escala":"Noturno"},
        {"nome":"JUNIOR","re":"59-01825","numero":"20903","equipe":"Energia","escala":"Noturno"},
        {"nome":"KAMILYN","re":"59-04350","numero":"24587","equipe":"Energia","escala":"Noturno"},
        {"nome":"LEANDRO","re":"59-03077","numero":"14791","equipe":"Energia","escala":"Noturno"},
        {"nome":"LUCIANO","re":"59-03444","numero":"23090","equipe":"Energia","escala":"Noturno"},
        {"nome":"MARCELO","re":"59-02318","numero":"23672","equipe":"Energia","escala":"Noturno"},
        {"nome":"PAULO","re":"59-01797","numero":"21031","equipe":"Energia","escala":"Noturno"},
        {"nome":"RODRIGO","re":"59-02849","numero":"","equipe":"Energia","escala":"Noturno"},
        {"nome":"RUTEMBERG","re":"59-00332","numero":"21096","equipe":"Energia","escala":"Noturno"},
        {"nome":"SIDNEI","re":"59-03370","numero":"24520","equipe":"Energia","escala":"Noturno"},
        {"nome":"VAGNER","re":"59-04500","numero":"24932","equipe":"Energia","escala":"Noturno"},
        {"nome":"VALTER","re":"59-00793","numero":"21131","equipe":"Energia","escala":"Noturno"},
        {"nome":"WILLIAM FAUSTO","re":"59-04340","numero":"24435","equipe":"Energia","escala":"Noturno"},
        {"nome":"WILLIAN ALMEIDA","re":"59-03331","numero":"22589","equipe":"Energia","escala":"Noturno"}
    ].sort((a,b) => a.nome.localeCompare(b.nome));

    const operacoesPadrao = [
        { nome: "Preparação", codigo: "0010" }, { nome: "Deslocamento", codigo: "0020" },
        { nome: "Acesso", codigo: "0030" }, { nome: "Impedimento", codigo: "0040" },
        { nome: "Desmobilização", codigo: "0050" }, { nome: "Execução", codigo: "0060" }
    ];

    function preencherFiltros() {
        const equipes = [...new Set(colaboradores.map(c => c.equipe))];
        const escalas = [...new Set(colaboradores.map(c => c.escala))];
        equipes.forEach(eq => { document.getElementById('filtroEquipe').add(new Option(eq, eq)); });
        escalas.forEach(es => { document.getElementById('filtroEscala').add(new Option(es, es)); });
    }

    function renderTabela(lista) {
        const tbody = document.querySelector('#tabela-colaboradores tbody');
        tbody.innerHTML = '';
        lista.forEach((c) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td><input type="checkbox" class="selecionar" data-re="${c.re}"></td>
                <td>${c.nome}</td><td>${c.re}</td><td>${c.numero}</td><td>${c.escala}</td><td>${c.equipe}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    function aplicarFiltros() {
        const eq = document.getElementById('filtroEquipe').value;
        const es = document.getElementById('filtroEscala').value;
        const filtrados = colaboradores.filter(c => (eq === '' || c.equipe === eq) && (es === '' || c.escala === es));
        renderTabela(filtrados);
    }

    function adicionarOperacao() {
        const ord = document.getElementById('numeroOrdem').value;
        if(!ord) return alert("Digite a Ordem!");
        const tbody = document.querySelector("#tabelaOperacoes tbody");
        const tr = document.createElement("tr");
        let options = operacoesPadrao.map(op => `<option value="${op.codigo}">${op.nome} (${op.codigo})</option>`).join('');
        let hoje = new Date().toISOString().slice(0,10);
        
        tr.innerHTML = `
            <td><select class="sel-op">${options}</select></td>
            <td class="cod-display">${operacoesPadrao[0].codigo}</td>
            <td><input type="date" value="${hoje}"></td>
            <td><input type="time"></td>
            <td><input type="date" value="${hoje}"></td>
            <td><input type="time"></td>
            <td><button onclick="this.closest('tr').remove()" style="background:#d9534f">X</button></td>
            <td style="display:none" class="ordem-val">${ord}</td>
        `;
        const sel = tr.querySelector('.sel-op');
        sel.onchange = () => tr.querySelector('.cod-display').textContent = sel.value;
        tbody.appendChild(tr);
    }

    function createTable() {
        const selectedREs = Array.from(document.querySelectorAll('.selecionar:checked')).map(cb => cb.dataset.re);
        const opsRows = document.querySelectorAll("#tabelaOperacoes tbody tr");
        if(selectedREs.length === 0 || opsRows.length === 0) return alert("Selecione a equipe e a operação!");

        const tbodyLacto = document.querySelector("#tabelaLancto tbody");
        tbodyLacto.innerHTML = "";

        opsRows.forEach(row => {
            const ordem = row.querySelector('.ordem-val').textContent;
            const cod = row.querySelector('.cod-display').textContent;
            const dIni = row.querySelectorAll('input[type="date"]')[0].value.split("-").reverse().join(".");
            const dFim = row.querySelectorAll('input[type="date"]')[1].value.split("-").reverse().join(".");
            const hIni = row.querySelectorAll('input[type="time"]')[0].value || "00:00";
            const hFim = row.querySelectorAll('input[type="time"]')[1].value || "00:00";

            selectedREs.forEach(re => {
                const p = colaboradores.find(c => c.re === re);
                const tr = document.createElement("tr");
                // MUDANÇA AQUI: Texto em inglês para desconhecidos
                let obs = p.numero === "" ? `UNKNOWN: ${p.nome} ${p.re}` : "";
                tr.innerHTML = `<td>${ordem}</td><td>${cod}</td><td>${p.numero}</td><td>${dIni}</td><td>${hIni}:00</td><td>${dFim}</td><td>${hFim}:00</td><td>${obs}</td>`;
                tbodyLacto.appendChild(tr);
            });
        });
    }

    function copiarFormatoPersonalizado() {
        const linhas = document.querySelectorAll("#tabelaLancto tbody tr");
        let texto = "";
        linhas.forEach(linha => {
            const col = Array.from(linha.querySelectorAll("td")).map(td => td.textContent.trim());
            texto += `${col[0]}\t${col[1]}${"\t".repeat(8)}${col.slice(2, 7).join("\t")}\t\t${col[7]}\n`;
        });
        navigator.clipboard.writeText(texto).then(() => alert("Copiado!"));
    }

    function excluirCorpo() { document.querySelector("#tabelaLancto tbody").innerHTML = ""; }

    preencherFiltros();
    renderTabela(colaboradores);
</script>
</body>
</html>
